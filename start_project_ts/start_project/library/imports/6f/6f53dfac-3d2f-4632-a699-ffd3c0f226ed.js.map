{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.ts"],"names":[],"mappings":";;;;;AAAM,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAG1C;IAA4B,0BAAY;IADxC;QAAA,qEA+IC;QA7IG,QAAQ;QAEA,gBAAU,GAAQ,CAAC,CAAC;QAC5B,UAAU;QAEF,kBAAY,GAAQ,CAAC,CAAC;QAC9B,QAAQ;QAEA,kBAAY,GAAQ,CAAC,CAAC;QAC9B,KAAK;QAEG,WAAK,GAAQ,CAAC,CAAC;QACvB,QAAQ;QAEA,eAAS,GAAc,IAAI,CAAC;QAE5B,YAAM,GAAQ,CAAC,CAAC;QAChB,aAAO,GAAS,KAAK,CAAC;QACtB,cAAQ,GAAS,KAAK,CAAC;QACvB,gBAAU,GAAW,IAAI,CAAC;;IA0HtC,CAAC;IAxHW,8BAAa,GAArB;QACI,MAAM;QACN,IAAI,MAAM,GAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,kBAAkB,EAAE,CAAC,CAAC;QAChG,IAAI;QACJ,IAAI,QAAQ,GAAC,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,EAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,iBAAiB,EAAE,CAAC,CAAC;QAClG,8BAA8B;QAC9B,IAAI,QAAQ,GAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,EAAC,IAAI,CAAC,CAAC;QAClD,6BAA6B;QAC7B,OAAO,EAAE,CAAC,aAAa,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,EAAC,QAAQ,EAAC,QAAQ,CAAC,CAAC,CAAC;IACnE,CAAC;IAEO,8BAAa,GAArB;QACI,YAAY;QACZ,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,SAAgB,EAAC,KAAK,EAAC,CAAC,CAAC,CAAC;IACvD,CAAC;IAEO,kCAAiB,GAAzB;QACI,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,QAAQ,EAAC,IAAI,CAAC,SAAS,EAAC,IAAI,CAAC,CAAC;QACzE,EAAE,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,SAAS,CAAC,MAAM,EAAC,IAAI,CAAC,OAAO,EAAC,IAAI,CAAC,CAAC;QACrE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAC,IAAI,CAAC,kBAAkB,EAAC,IAAI,CAAC,CAAC;QACjF,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,EAAC,IAAI,CAAC,gBAAgB,EAAC,IAAI,CAAC,CAAC;QAChF,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAC,IAAI,CAAC,gBAAgB,EAAC,IAAI,CAAC,CAAC;IACjF,CAAC;IAEO,yBAAQ,GAAhB;QACI,IAAI,CAAC,OAAO,GAAC,IAAI,CAAC;QAClB,IAAI,CAAC,QAAQ,GAAC,KAAK,CAAC;IACxB,CAAC;IAEO,0BAAS,GAAjB;QACI,IAAI,CAAC,OAAO,GAAC,KAAK,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAC,IAAI,CAAC;IACvB,CAAC;IAEO,yBAAQ,GAAhB;QACI,IAAI,CAAC,OAAO,GAAC,KAAK,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAC,KAAK,CAAC;IACxB,CAAC;IAEO,mCAAkB,GAA1B,UAA2B,KAAyB;QAChD,IAAG,KAAK,CAAC,YAAY,EAAE,GAAC,EAAE,CAAC,OAAO,CAAC,KAAK,GAAC,CAAC,EAAC;YACvC,IAAI,CAAC,SAAS,EAAE,CAAC;SACpB;aAAI;YACD,IAAI,CAAC,QAAQ,EAAE,CAAC;SACnB;IACL,CAAC;IAEO,iCAAgB,GAAxB;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAEO,0BAAS,GAAjB,UAAkB,KAA4B;QAC1C,QAAQ,KAAa,CAAC,OAAO,EAAC;YAC1B,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;YACd,KAAK,EAAE,CAAC,GAAG,CAAC,IAAI;gBACZ,IAAI,CAAC,QAAQ,EAAE,CAAC;gBAChB,MAAM;YACV,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;YACd,KAAK,EAAE,CAAC,GAAG,CAAC,KAAK;gBACb,IAAI,CAAC,SAAS,EAAE,CAAC;gBACjB,MAAM;SACb;IACL,CAAC;IAEO,wBAAO,GAAf,UAAgB,KAA4B;QACxC,QAAQ,KAAa,CAAC,OAAO,EAAC;YAC1B,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;YACd,KAAK,EAAE,CAAC,GAAG,CAAC,IAAI;gBACZ,IAAI,CAAC,QAAQ,EAAE,CAAC;gBAChB,MAAM;YACV,KAAK,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;YACd,KAAK,EAAE,CAAC,GAAG,CAAC,KAAK;gBACb,IAAI,CAAC,QAAQ,EAAE,CAAC;gBAChB,MAAM;SACb;IACL,CAAC;IAES,uBAAM,GAAhB;QACI,SAAS;QACT,IAAI,CAAC,UAAU,GAAC,IAAI,CAAC,aAAa,EAAE,CAAC;QACrC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAErC,SAAS;QACT,IAAI,CAAC,OAAO,GAAC,KAAK,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAC,KAAK,CAAC;QACpB,YAAY;QACZ,IAAI,CAAC,MAAM,GAAC,CAAC,CAAC;QAEd,SAAS;QACT,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC7B,CAAC;IAES,uBAAM,GAAhB,UAAiB,EAAS;QACtB,iBAAiB;QACjB,IAAG,IAAI,CAAC,OAAO,EAAC;YACZ,IAAI,CAAC,MAAM,IAAE,IAAI,CAAC,KAAK,GAAC,EAAE,CAAC;SAC9B;aAAK,IAAG,IAAI,CAAC,QAAQ,EAAC;YACnB,IAAI,CAAC,MAAM,IAAE,IAAI,CAAC,KAAK,GAAC,EAAE,CAAC;SAC9B;QACD,gBAAgB;QAChB,IAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,GAAC,IAAI,CAAC,YAAY,EAAC;YACvC,IAAI,CAAC,MAAM,GAAC,IAAI,CAAC,YAAY,GAAC,IAAI,CAAC,MAAM,GAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACnE;QAED,eAAe;QACf,IAAI,CAAC,IAAI,CAAC,CAAC,IAAE,IAAI,CAAC,MAAM,GAAC,EAAE,CAAC;QAC5B,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,IAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,EAAC;YACtC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,CAAC;SACxC;QACD,IAAG,IAAI,CAAC,IAAI,CAAC,CAAC,GAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,EAAC;YACpC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAC,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,GAAC,CAAC,CAAC;SACzC;IACL,CAAC;IAED,wBAAwB;IAExB,sBAAK,GAAL;IAEA,CAAC;IAzID;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;8CACO;IAG5B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;gDACS;IAG9B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;gDACS;IAG9B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;yCACE;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;6CACa;IAf3B,MAAM;QADlB,OAAO;OACK,MAAM,CA8IlB;IAAD,aAAC;CA9ID,AA8IC,CA9I2B,EAAE,CAAC,SAAS,GA8IvC;AA9IY,wBAAM","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport class Player extends cc.Component {\r\n    //主角跳跃高度\r\n    @property(cc.Integer)\r\n    private jumpHeight:number=0;\r\n    //主角跳跃持续时间\r\n    @property(cc.Integer)\r\n    private jumpDuration:number=0;\r\n    //最大移动速度\r\n    @property(cc.Integer)\r\n    private maxMoveSpeed:number=0;\r\n    //加速度\r\n    @property(cc.Integer)\r\n    private accel:number=0;\r\n    //跳跃音效资源\r\n    @property(cc.AudioClip)\r\n    private jumpAudio:cc.AudioClip=null;\r\n\r\n    private xSpeed:number=0;\r\n    private accLeft:boolean=false;\r\n    private accRight:boolean=false;\r\n    private jumpAction:cc.Action=null;\r\n\r\n    private setJumpAction(){\r\n        //跳跃上升\r\n        let jumpUp=cc.moveBy(this.jumpDuration,cc.p(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        //下落\r\n        let jumpDown=cc.moveBy(this.jumpDuration,cc.p(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        //添加一个回调函数，用于在动作结束时调用我们定义的其他方法\r\n        let callback=cc.callFunc(this.playJumpSound,this);\r\n        //不断重复，而且每次完成落地动作后调用回调函数来播放声音\r\n        return cc.repeatForever(cc.sequence(jumpUp,jumpDown,callback));\r\n    }\r\n\r\n    private playJumpSound(){\r\n        //调用声音引擎播放声音\r\n        cc.audioEngine.play(this.jumpAudio as any,false,1);\r\n    }\r\n\r\n    private addEventListeners(){\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_START,this.onScreenTouchStart,this);\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_CANCEL,this.onScreenTouchEnd,this);\r\n        cc.find(\"Canvas\").on(cc.Node.EventType.TOUCH_END,this.onScreenTouchEnd,this);\r\n    }\r\n\r\n    private moveLeft(){\r\n        this.accLeft=true;\r\n        this.accRight=false;\r\n    }\r\n\r\n    private moveRight(){\r\n        this.accLeft=false;\r\n        this.accRight=true;\r\n    }\r\n\r\n    private stopMove(){\r\n        this.accLeft=false;\r\n        this.accRight=false;\r\n    }\r\n\r\n    private onScreenTouchStart(event:cc.Event.EventTouch){\r\n        if(event.getLocationX()>cc.winSize.width/2){\r\n            this.moveRight();\r\n        }else{\r\n            this.moveLeft();\r\n        }\r\n    }\r\n\r\n    private onScreenTouchEnd(){\r\n        this.stopMove();\r\n    }\r\n\r\n    private onKeyDown(event:cc.Event.EventKeyboard){\r\n        switch((event as any).keyCode){\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.moveLeft();\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.moveRight();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private onKeyUp(event:cc.Event.EventKeyboard){\r\n        switch((event as any).keyCode){\r\n            case cc.KEY.a:\r\n            case cc.KEY.left:\r\n                this.stopMove();\r\n                break;\r\n            case cc.KEY.d:\r\n            case cc.KEY.right:\r\n                this.stopMove();\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected onLoad(){\r\n        //初始化跳跃动作\r\n        this.jumpAction=this.setJumpAction();\r\n        this.node.runAction(this.jumpAction);\r\n\r\n        //加速度方向开关\r\n        this.accLeft=false;\r\n        this.accRight=false;\r\n        //当前主角水平方向速度\r\n        this.xSpeed=0;\r\n\r\n        //初始化输入监听\r\n        this.addEventListeners();\r\n    }\r\n\r\n    protected update(dt:number){\r\n        //根据当前加速度方向每帧更新速度\r\n        if(this.accLeft){\r\n            this.xSpeed-=this.accel*dt;\r\n        }else if(this.accRight){\r\n            this.xSpeed+=this.accel*dt;\r\n        }\r\n        //限制主角的速度不能超过最大值\r\n        if(Math.abs(this.xSpeed)>this.maxMoveSpeed){\r\n            this.xSpeed=this.maxMoveSpeed*this.xSpeed/Math.abs(this.xSpeed);\r\n        }\r\n\r\n        //根据当前速度更新主角的位置\r\n        this.node.x+=this.xSpeed*dt;\r\n        if(this.node.x<=-this.node.parent.width/2){\r\n            this.node.x=this.node.parent.width/2;\r\n        }\r\n        if(this.node.x>this.node.parent.width/2){\r\n            this.node.x=-this.node.parent.width/2;\r\n        }\r\n    }\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n}\r\n"]}