{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["import { Player } from \"./Player\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport class Game extends cc.Component {\r\n\r\n    //这个属性引用了星星的预制资源\r\n    @property(cc.Prefab)\r\n    private starPrefab:cc.Prefab=null;\r\n    //星星产生后消失时间的随机范围\r\n    @property(cc.Integer)\r\n    private maxStarDuration=0;\r\n    @property(cc.Integer)\r\n    private minStarDuration=0;\r\n    //地面节点，用于确定星星生成的高度\r\n    @property(cc.Node)\r\n    private groundNode:cc.Node=null;\r\n    //player节点，用于获取主角弹跳的高度，和控制主角行动开关\r\n    @property(cc.Node)\r\n    public playerNode:cc.Node=null;\r\n    //score label的引用\r\n    @property(cc.Label)\r\n    private scoreLabel:cc.Label=null;\r\n    //得分音效资源\r\n    @property(cc.AudioClip)\r\n    private scoreAudio:cc.AudioClip=null;\r\n\r\n    //地面节点的y坐标\r\n    private groundY:number;\r\n    //定时器\r\n    public timer:number;\r\n    //星星存在的持续时间\r\n    public starDuration:number;\r\n    //当前分数\r\n    private score:number;\r\n\r\n    protected onLoad(){\r\n        //获取地平面的y坐标\r\n        this.groundY=this.groundNode.y+this.groundNode.height/2;\r\n        //初始化计时器\r\n        this.timer=0;\r\n        this.starDuration=0;\r\n        //生成一个新的星星\r\n        this.spawnNewStar();\r\n        //初始化计分\r\n        this.score=0;\r\n    }\r\n\r\n    //生成一个新的星星\r\n    public spawnNewStar(){\r\n        //使用给定的模板在场景中生成一个新的节点\r\n        let newStar=cc.instantiate(this.starPrefab);\r\n        //将新赠的节点添加到Canvas节点下面\r\n        this.node.addChild(newStar);\r\n        //为星星设置一个随机位置\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        //将Game组件的实例传入星星组件\r\n        newStar.getComponent('Star').init(this);\r\n        //重置计时器\r\n        this.starDuration=this.minStarDuration+cc.random0To1()*(this.maxStarDuration-this.minStarDuration);\r\n        this.timer=0;\r\n    }\r\n\r\n    //新星星的位置\r\n    public getNewStarPosition(){\r\n        let randX=0;\r\n        //根据地平面位置和主角跳跃高度，随机得到一个星星的y坐标\r\n        let randY=this.groundY+cc.random0To1()*this.playerNode.getComponent('Player').jumpHeight+50;\r\n        //根据屏幕宽度，随机得到一个星星x坐标\r\n        let maxX=this.node.width/2;\r\n        randX=cc.randomMinus1To1()*maxX;\r\n        //返回星星坐标\r\n        return cc.p(randX,randY);\r\n    }\r\n\r\n    protected update(dt:number){\r\n        //每帧更新计时器，超过限度还没有生成新的星星\r\n        //就会调用游戏失败逻辑\r\n        if(this.timer>this.starDuration){\r\n            this.gameOver();\r\n            return;\r\n        }\r\n        this.timer+=dt;\r\n    }\r\n\r\n    //得分\r\n    public gainScore(){\r\n        this.score+=1;\r\n        //更新scoreDisplay的文字\r\n        this.scoreLabel.string='Score : '+this.score.toString();\r\n        //播放得分音效\r\n        //不加as any会报错\r\n        cc.audioEngine.play(this.scoreAudio as any,false,1);\r\n    }\r\n\r\n    //gg\r\n    private gameOver(){\r\n        //停止player节点跳跃动作\r\n        this.playerNode.stopAllActions();\r\n        cc.director.loadScene('game');\r\n    }\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    start () {\r\n\r\n    }\r\n\r\n}\r\n"]}